(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5e5f12aa"],{"9de7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-security"},[a("HeaderBar"),a("div",{staticClass:"main",style:{minHeight:t.$window.innerHeight-150+"px"}},[a("div",{staticClass:"content"},[t._m(0),t.pageData.haveTrustee?a("li",[a("div",[t._v("平台账号：")]),a("div",[t._v(t._s(t.currentAddr.userName))])]):a("li",[a("div",[t._v("平台账号：")]),a("div",{staticClass:"operation"},[t._v("暂未绑定"),a("span",{on:{click:function(e){t.phoneBind=!0}}},[t._v("去绑定")])])]),t._l(t.pageData.MetaMaskAddress,function(e){return a("li",[a("div",[t._v("MetaMask地址：")]),a("div",[t._v(t._s(e.coinAddress))])])}),0==t.pageData.MetaMaskAddress.length&&t.pageData.haveTrustee?a("li",[a("div",[t._v("MetaMask地址：")]),a("div",[t._v("暂未绑定，请登录MetaMask将自动绑定，若已登录请刷新页面")])]):t._e(),t.pageData.haveTrustee?a("li",[a("div",[t._v("登录密码：")]),a("div",{staticClass:"operation"},[t._v("********"),a("span",{on:{click:function(e){t.resetPassDialog=!0}}},[t._v("修改")])])]):a("li",[a("div",[t._v("登录密码：")]),a("div",[t._v("暂无")])])],2)]),a("mu-dialog",{staticClass:"register-accout",attrs:{open:t.phoneBind,"append-body":!1},on:{"update:open":function(e){t.phoneBind=e}}},[a("h4",[t._v("绑定手机账号")]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("账号")]),a("div",{staticClass:"input-flex prefix"},[a("mu-menu",{attrs:{cover:"",open:t.prefixMenu},on:{"update:open":function(e){t.prefixMenu=e}}},[a("span",{attrs:{color:"primary"}},[t._v(t._s(t.formData.prefix))]),a("mu-list",{attrs:{slot:"content"},slot:"content"},t._l(t.prefixs,function(e){return a("mu-list-item",{key:e,attrs:{button:""},on:{click:function(a){t.formData.prefix=e,t.prefixMenu=!1}}},[a("mu-list-item-title",[t._v(t._s(e))])],1)}))],1),a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.phone,expression:"formData.phone",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入您的手机号码"},domProps:{value:t.formData.phone},on:{input:function(e){e.target.composing||t.$set(t.formData,"phone",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})],1)]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("图形码")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.picCode,expression:"formData.picCode"}],attrs:{type:"text",placeholder:"请输入图形验证码"},domProps:{value:t.formData.picCode},on:{input:function(e){e.target.composing||t.$set(t.formData,"picCode",e.target.value)}}}),a("img",{ref:"imgcode",attrs:{src:t.$window.SERVERPATH+"/open/pic_captcha?type=ACCOUNT_BINDING&macCode=macCode",alt:""},on:{click:function(e){t.getImgCode("ACCOUNT_BINDING")}}})])]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("验证码")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.captcha,expression:"formData.captcha"}],attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:t.formData.captcha},on:{input:function(e){e.target.composing||t.$set(t.formData,"captcha",e.target.value)}}}),a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.getSMScode("ACCOUNT_BINDING")}}},[t._v(t._s(t.formData.btnText))])])]),a("button",{on:{click:function(e){t.bindingOneDo("PHONE")}}},[t._v("绑定")]),a("p",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.phoneBind=!1,t.registerEmailAccount=!0}}},[t._v("绑定邮箱")])])]),a("mu-dialog",{staticClass:"register-accout",attrs:{open:t.registerEmailAccount,"append-body":!1},on:{"update:open":function(e){t.registerEmailAccount=e}}},[a("h4",[t._v("绑定邮箱账号")]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("邮箱")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.formData.email,expression:"formData.email",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"请输入您的邮箱账号"},domProps:{value:t.formData.email},on:{input:function(e){e.target.composing||t.$set(t.formData,"email",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("验证码")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.emailCaptcha,expression:"formData.emailCaptcha"}],attrs:{type:"text",placeholder:"请输入短信验证码"},domProps:{value:t.formData.emailCaptcha},on:{input:function(e){e.target.composing||t.$set(t.formData,"emailCaptcha",e.target.value)}}}),a("a",{attrs:{href:"javascript:;"},on:{click:t.getSMScode}},[t._v(t._s(t.formData.btnText))])])]),a("button",{on:{click:t.bindingOneDo}},[t._v("绑定")]),a("p",[a("a",{attrs:{href:"javascript:;"},on:{click:function(e){t.phoneBind=!0,t.registerEmailAccount=!1}}},[t._v("绑定手机号")])])]),a("mu-dialog",{staticClass:"register-accout",attrs:{open:t.confirmAccountNotExist,"append-body":!1},on:{"update:open":function(e){t.confirmAccountNotExist=e}}},[a("h4",[t._v("绑定账号")]),a("div",{staticClass:"input-wrap",staticStyle:{width:"338px"}},[a("label",[t._v("密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.loginPwd,expression:"formData.loginPwd"}],attrs:{type:"password",placeholder:"字母数字组成，不超过12位"},domProps:{value:t.formData.loginPwd},on:{input:function(e){e.target.composing||t.$set(t.formData,"loginPwd",e.target.value)}}})]),a("div",{staticClass:"input-wrap",staticStyle:{width:"338px"}},[a("label",[t._v("确认密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.loginPwd2,expression:"formData.loginPwd2"}],attrs:{type:"text",placeholder:"请再次输入您的密码"},domProps:{value:t.formData.loginPwd2},on:{input:function(e){e.target.composing||t.$set(t.formData,"loginPwd2",e.target.value)}}})]),a("button",{on:{click:function(e){t.bindingTwoDo("PHONE")}}},[t._v("确认")])]),a("mu-dialog",{staticClass:"register-accout",attrs:{open:t.resetPassDialog,"append-body":!1},on:{"update:open":function(e){t.resetPassDialog=e}}},[a("h4",[t._v("重置登陆密码")]),a("div",{staticClass:"input-wrap"},[a("p",[t._v("账号:　　"+t._s(t.currentAddr.userName))])]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("图形码")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.picCode,expression:"formData.picCode"}],attrs:{type:"text",placeholder:"请输入图形验证码"},domProps:{value:t.formData.picCode},on:{input:function(e){e.target.composing||t.$set(t.formData,"picCode",e.target.value)}}}),a("img",{ref:"imgcode",attrs:{src:t.$window.SERVERPATH+"/open/pic_captcha?type=REGISTER&macCode=macCode",alt:""},on:{click:t.getImgCode}})])]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("验证码")]),a("div",{staticClass:"input-flex"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.resetCaptcha,expression:"formData.resetCaptcha"}],attrs:{type:"text",placeholder:"请输入验证码"},domProps:{value:t.formData.resetCaptcha},on:{input:function(e){e.target.composing||t.$set(t.formData,"resetCaptcha",e.target.value)}}}),a("a",{attrs:{href:"javascript:;"},on:{click:t.getSMScode}},[t._v(t._s(t.formData.btnText))])])]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("新的密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.resetLoginPwd,expression:"formData.resetLoginPwd"}],attrs:{type:"password",placeholder:"字母数字组成，不超过12位"},domProps:{value:t.formData.resetLoginPwd},on:{input:function(e){e.target.composing||t.$set(t.formData,"resetLoginPwd",e.target.value)}}})]),a("div",{staticClass:"input-wrap"},[a("label",[t._v("确认密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.resetLoginPwd2,expression:"formData.resetLoginPwd2"}],attrs:{type:"text",placeholder:"请再次输入您的密码"},domProps:{value:t.formData.resetLoginPwd2},on:{input:function(e){e.target.composing||t.$set(t.formData,"resetLoginPwd2",e.target.value)}}})]),a("button",{on:{click:t.passResetDo}},[t._v("确认修改")])]),a("FooterBar",{ref:"ft"})],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",{staticClass:"title"},[a("span",[t._v("账户安全")]),a("span")])}],s=(a("ac6a"),a("c93e")),n=(a("cadf"),a("551c"),a("097d"),a("fca0")),r=a("348c"),c=a("052d"),p=a("2f62"),d={data:function(){return{ethPrice:15.3,phoneBind:!1,registerEmailAccount:!1,confirmAccountExist:!1,confirmAccountNotExist:!1,resetPassDialog:!1,prefixs:["+86","+852","+853","+886","+8801","+8802","+001","+44","+0061"],prefixMenu:!1,formData:{phone:"",prefix:"+86",captcha:"",picCode:"",loginPwdCheck:"",loginPwd:"",loginPwd2:"",s:60,btnText:"获取验证码",timer:null,email:"",emailCaptcha:"",resetCaptcha:"",resetLoginPwd:"",resetLoginPwd2:"",bindingType:"PHONE"},pageData:{isBind:!1,haveTrustee:!1,MetaMaskAddress:[]}}},watch:{currentAddr:function(){this.pageData={isBind:!1,haveTrustee:!1,MetaMaskAddress:[]},this.getAssets()}},mounted:function(){this.getAssets()},computed:Object(s["a"])({},Object(p["c"])({currentAddr:function(t){return t.user.currentAddr},storeWeb3:function(t){return t.web3Handler.web3}})),components:{HeaderBar:n["a"],FooterBar:r["a"]},methods:Object(s["a"])({getImgCode:function(t){this.$refs.imgcode.src=this.$window.SERVERPATH+"/open/pic_captcha?type="+t+"&macCode=macCode&"+Math.random()},getSMScode:function(t){var e=this;this.verifyPhone()&&this.verifyPicCode()&&(this.registerSMScountDown(),this.$http.post("/open/captcha",{macCode:"macCode",picCode:this.formData.picCode,phone:this.formData.phone,prefix:this.formData.prefix,type:t}).then(function(t){console.log(t),200!=t.code&&(clearTimeout(e.formData.timer),e.formData.btnText="获取验证码")}).catch(function(t){clearTimeout(e.formData.timer),e.formData.btnText="获取验证码"}))},registerSMScountDown:function(){this.formData.s>0?(this.formData.s--,this.formData.btnText=this.formData.s+"s",this.formData.timer=setTimeout(this.registerSMScountDown,1e3)):(this.formData.s=60,this.formData.btnText="获取验证码")},bindingOneDo:function(t){var e=this,a={account:this.formData.phone,bindingType:t,captcha:this.formData.captcha};if("PHONE"==t){if(!this.verifyPhone()||!this.verifyCaptcha())return}else if(!this.verifyEmail()||!this.verifyCaptcha())return;this.$http.post("/app/user/binding",a).then(function(t){e.phoneBind=!1,200==t.code&&(t.result?e.web3BindAddress(t.result):e.confirmAccountNotExist=!0)})},bindingTwoDo:function(t){var e=this,a={account:this.formData.phone,password:Object(c["a"])(this.formData.loginPwd)};if("PHONE"==t){if(!this.verifyPhone()||!this.verifyCaptcha())return}else if(!this.verifyEmail()||!this.verifyCaptcha())return;this.verifyPassword()&&this.$http.post("/app/user/binding_two",a).then(function(t){e.phoneBind=!1,console.log(t),200==t.code&&t.result&&(e.confirmAccountNotExist=!1,e.web3BindAddress(t.result))})},passResetDo:function(){var t=this;""!=this.formData.resetCaptcha?""!=this.formData.resetLoginPwd?""!=this.formData.resetLoginPwd2?this.formData.resetLoginPwd==this.formData.resetLoginPwd2?this.$http.post("/app/user/password",{captcha:this.formData.resetCaptcha,pwd:Object(c["a"])(this.formData.resetLoginPwd)}).then(function(e){console.log(e),200==e.code&&(t.alert({type:"success",msg:e.msg}),t.resetPassDialog=!1)}):this.alert({type:"info",msg:"两次输入的密码不一致"}):this.alert({type:"info",msg:"再次确认密码不能为空"}):this.alert({type:"info",msg:"密码不能为空"}):this.alert({type:"info",msg:"短信验证码不能为空"})},getAssets:function(){var t=this;this.$http.get("/app/user/assets").then(function(e){if(200==e.code){var a=e.result.assets;a.length>1&&(t.pageData.isBind=!0),a.forEach(function(e){"IMPORT"==e.platform?t.pageData.MetaMaskAddress.push(e):t.pageData.haveTrustee=!0})}})},verifyPhone:function(){return!(""==this.formData.phone||!/^[0-9]*$/.test(this.formData.phone))||(this.alert({type:"info",msg:"手机号输入有误"}),!1)},verifyPicCode:function(){return""!=this.formData.picCode||(this.alert({type:"info",msg:"图形验证码不能为空"}),!1)},verifyCaptcha:function(){return""!=this.formData.captcha||(this.alert({type:"info",msg:"验证码不能为空"}),!1)},verifyPassword:function(){var t=/^[a-zA-Z]\w{7,12}$/;return t.test(this.formData.loginPwd)?this.formData.loginPwd===this.formData.loginPwd2||(this.alert({type:"info",msg:"两次密码输入不一致"}),!1):(this.alert({type:"info",msg:"密码必须为8-12位数字字母的组合"}),!1)},web3BindAddress:function(t){var e=this;this.storeWeb3.apiHandle.methods.bindAddress(t).send({from:this.currentAddr.coinAddress}).on("receipt",function(t){e.alert({type:"success",msg:"操作成功"})}).on("error",function(t){e.alert({type:"error",msg:"操作失败"})})}},Object(p["b"])({changeLanguage:"CHANGE_LANGUAGE",alert:"alert"}))},l=d,m=(a("d384"),a("2877")),u=Object(m["a"])(l,i,o,!1,null,null,null);u.options.__file="Account-security.vue";e["default"]=u.exports},d384:function(t,e,a){"use strict";var i=a("f9fa"),o=a.n(i);o.a},f9fa:function(t,e,a){}}]);